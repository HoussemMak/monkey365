{
    "dashboard_name":  "Exchange Online",
    "menu_name":  "Microsoft 365",
    "issue_name":  "Ensure the Common Attachment Types Filter is enabled",
    "description":  "The Common Attachment Types Filter lets a user block known and custom malicious file types from being attached to emails.",
    "rationale":  "Blocking known malicious file types can help prevent malware-infested files from infecting a host.",
    "impact":  "Blocking common malicious file types should not cause an impact in modern computing environments.",
    "remediation":  '
					###### To enable the Common Attachment Types Filter, use the Microsoft 365 Admin Portal
					1. Click `Security` to open the Security portal.
					2. Navigate to `Threat management`, then `Policy`, and select `Anti-malware`.
					3. Edit the `Default` profile, then click Edit protection settings at the bottom of the window.
					4. Select `Enable the common attachments filter`.
					5. Click `Save`.
					
					###### To enable the Common Attachment Types Filter, use the Exchange Online PowerShell Module
					1. Connect to Exchange Online using `Connect-ExchangeOnline`
					2. Run the following PowerShell command:					
					```powershell
					Set-MalwareFilterPolicy -Identity Default -EnableFileFilter $true
					```
	',
    "references":  [
                       "https://docs.microsoft.com/en-us/powershell/module/exchange/antispam-antimalware/Get-MalwareFilterPolicy?view=exchange-ps",
					   "https://docs.microsoft.com/en-us/office365/SecurityCompliance/configure-anti-malware-policies#use-remote-powershell-to-configure-anti-malware-policies",
					   "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-malware-protection?view=o365-worldwide"
                   ],
    "compliance":  [
                       {
                           "name":  "CIS Microsoft 365 Foundations",
                           "version":  "1.4.0",
                           "reference":  "4.1"
                       }
                   ],
    "tags":  null,
    "path":  "o365_exo_malware_policy",
    "display_path":  "o365_exo_malware_policy",
    "conditions":  [
                       "and",
                       [
                           "isEnabled",
                           "eq",
                           "True"
                       ],
                       [
                           "and",
                           [
								"or",
								[
									"Policy.EnableFileFilter",
									"ne",
									"true"
								],
								[
									"Policy.FileTypes.Count",
									"eq",
									"0"
								]
                           ]
                       ]
   ],
    "id_suffix":  "o365_exo_attachment_type_filter_disabled"
}
