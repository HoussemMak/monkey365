{
  "serviceType": "SQL Server",
  "serviceName": "Databases",
  "displayName": "Ensure that VA setting 'Also send email notifications to admins and subscription owners' is set for a SQL server",
  "description": "Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.",
  "rationale": "VA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admins and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.",
  "impact": "Enabling the **Microsoft Defender for Cloud** for SQL features will incur additional costs for each SQL server.",
  "remediation": "\r\n\t\t\t\t\t###### From Azure Console\r\n\t\t\t\t\t1. Go to `SQL servers`.\r\n\t\t\t\t\t2. Select a server instance\r\n\t\t\t\t\t3. Click on `Microsoft Defender for Cloud`\r\n\t\t\t\t\t4. Ensure that `Microsoft Defender for Cloud for SQL` is set to `Enabled`\r\n\t\t\t\t\t5. In Section `Vulnerability Assessment Settings`, Ensure Storage Accounts is configured.\r\n\t\t\t\t\t6. Check/enable \"Also send email notifications to admins and subscription owners\"\r\n\t\t\t\t\t7. Click `Save`\r\n\t",
  "references": [
    "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
    "https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver",
    "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0",
    "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0",
    "https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessment"
  ],
  "compliance": [
    {
      "name": "CIS Microsoft Azure Foundations",
      "version": "1.4.0",
      "reference": "4.2.5"
    }
  ],
  "level": "medium",
  "tags": null,
  "path": "az_sql_servers",
  "conditions": [
    {
      "statements": [
        {
          "conditions": [
            [
              "vaConfig.properties.recurringScans.emailSubscriptionAdmins",
              "ne",
              "true"
            ]
          ]
        }
      ]
    }
  ],
  "idSuffix": "sql_server_va_send_reports_admins_disabled",
  "status": {
    "keyName": [],
    "message": ""
  },
  "notes": [],
  "categories": [],
  "fields": {
    "resourceName": null,
    "resourceId": null,
    "resourceType": null
  }
}
