{
    "serviceType":  "SQL Server",
    "serviceName":  "Databases",
    "displayName":  "Ensure that VA setting Send scan reports to is configured for a SQL server",
    "description":  "Configure 'Send scan reports to' with email ids of concerned data owners/stakeholders for a critical SQL servers.",
    "rationale":  "Vulnerability Assessment (VA) scan reports and alerts will be sent to email ids configured at 'Send scan reports to'. This may help in reducing time required for identifying risks and taking corrective measures.",
    "impact":  "Enabling the **Microsoft Defender for Cloud** for SQL features will incur additional costs for each SQL server.",
    "remediation":  '
					###### From Azure Console
					1. Go to `SQL servers`.
					2. Select a server instance
					3. Click on `Microsoft Defender for Cloud`
					4. Ensure that `Microsoft Defender for Cloud for SQL` is set to `Enabled`
					5. In Section `Vulnerability Assessment Settings`, Ensure Storage Accounts is configured.
					6. In Section `Vulnerability Assessment Settings`, Ensure Send scan reports to is not empty
	',
    "references":  [
                       "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
					   "https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver",
					   "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0",
					   "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0",
					   "https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessment"
	],
    "compliance":  [
		{
			"name":  "CIS Microsoft Azure Foundations",
			"version":  "1.4.0",
			"reference":  "4.2.4"
		}
	],
	"level": "medium",
    "tags":  null,
    "path":  "az_sql_servers",
    "conditions":  [
		{
			statements:  [
				{
					conditions:  [
						["vaConfig.properties.recurringScans.emails.Count","eq","0"]
					]
				}
			]
		}
	],
    "idSuffix":  "sql_server_va_send_reports_empty"
}
